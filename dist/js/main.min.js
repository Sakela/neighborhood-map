function initMap(){"use strict";map=new google.maps.Map(document.getElementById("map"),{center:{lat:33.7489954,lng:-84.3879824},zoom:13}),ko.applyBindings(new MapViewModel)}var map,ListItem=function(e){"use strict";this.id=ko.observable(e.venue.id),this.name=ko.observable(e.venue.name.toUpperCase()),this.phoneNumber=ko.observable(e.venue.contact.phone),this.address=ko.observable(e.venue.location.address),this.formattedAddress=ko.observable(e.venue.location.formattedAddress),this.categories=ko.observable(e.venue.categories[0].name),this.rating=ko.observable(e.venue.rating),this.url=ko.observable(e.venue.url),this.image=ko.observable(e.venue.photos),this.firstImage=ko.observable()},MapViewModel=function(){"use strict";function e(e){var t={query:e};l.textSearch(t,function(e,t){if(t==google.maps.places.PlacesServiceStatus.OK){if(t==google.maps.places.PlacesServiceStatus.OK){$(".error-search").css("display","none");var n={};n.lat=e[0].geometry.location.lat(),n.lng=e[0].geometry.location.lng();var o=new google.maps.LatLng(e[0].geometry.location.lat(),e[0].geometry.location.lng());map.setCenter(o),a.getDetails(n)}}else $(".error-search").css("display","block")})}function t(e){var t=new google.maps.LatLng(e.venue.location.lat,e.venue.location.lng),o=new google.maps.Marker({map:null,position:t,animation:google.maps.Animation.DROP,icon:u,name:e.venue.name,id:e.venue.id,vicinity:e.venue.location.address});google.maps.event.addListener(o,"click",function(){n(this),s(o,r),r.open(map,this),a.searchText(this.name)}),c.push(o),a.showListings()}function n(e){c.forEach(function(e){e.setIcon(u)}),e.setIcon(p)}function o(e){return new google.maps.MarkerImage("http://chart.googleapis.com/chart?chst=d_map_spin&chld=1.15|0|"+e+"|40|_|%E2%80%A2",new google.maps.Size(21,34),new google.maps.Point(0,0),new google.maps.Point(10,34),new google.maps.Size(21,34))}function s(e,t){t.setContent('<div class="info-window"><h3>'+e.name+"</h3><p>"+e.vicinity+'</p><a class="info-window-url" href="https://foursquare.com/" target="_blank">Powered By Foursquare <i class="fa fa-foursquare fa-lg" aria-hidden="true"></i></a></div>')}function i(e){$.ajax({url:"https://api.foursquare.com/v2/venues/"+e.venue.id+"/photos?limit=1&client_id=RG0BDGPCIXRYCKU3MGO2K4NSMZQMEZG3PVX1IEQQ1W5V5OMF&client_secret=1OVPLSTAD3E0PNUHRMZVSFC24NJS0YATRZSTZ0BCWGPU5AKU&v=20130815",dataType:"jsonp",success:function(t){var n="https://irs3.4sqi.net/img/general/width100"+t.response.photos.items[0].suffix;e.venue.photos=n,a.placeList.push(new ListItem(e))}})}var a=this,r=new google.maps.InfoWindow({maxWidth:350}),l=new google.maps.places.PlacesService(map),c=[],u=(document.getElementById("show-listings"),document.getElementById("hide-listings"),o("8E4E81")),p=o("fc00b5");a.placeList=ko.observableArray([]),a.currentPlace=ko.observable(),a.enableButton=ko.observable(!0),a.searchText=ko.observable(""),a.currentWeather=ko.observable(),a.cityInput=ko.observable("Atlanta"),a.toggleList=function(){"none"===$(".list").css("display")?($(".list").toggle(100),$("#map").css({height:"40%"}),$(".footer").css({display:"none"}),$(".list").css({height:"53%"})):window.innerWidth<500?($(".list").toggle(100),$("#map").css({height:"85%"}),$(".footer").css({display:"inline-block"})):($(".list").toggle(100),$("#map").css({height:"76%"}),$(".footer").css({display:"inline-block"}))},a.clearFilter=function(){a.searchText("")},a.setCurrentPlace=function(e){a.currentPlace(e)},a.searchResults=ko.computed(function(){var e=[],t=new RegExp(a.searchText(),"i");return a.placeList().forEach(function(n){-1!==n.name().search(t)&&e.push(n)}),e}),a.getDetails=function(e){$.ajax({url:"https://api.foursquare.com/v2/venues/explore?ll="+e.lat+","+e.lng+"&client_id=RG0BDGPCIXRYCKU3MGO2K4NSMZQMEZG3PVX1IEQQ1W5V5OMF&client_secret=1OVPLSTAD3E0PNUHRMZVSFC24NJS0YATRZSTZ0BCWGPU5AKU&v=20170919&venuePhotos=1",success:function(e){$(".error").css("display","none");e.response.groups[0].items.forEach(function(e){t(e),i(e)})},error:function(e,t,n){$(".error").css("display","block")}})},e(a.cityInput()),$("#menu-city-search").change(function(){a.hideListings(),c.length=0,a.placeList().length=0;var t=$("#menu-city-search").val();a.cityInput(t),e(a.cityInput())}),a.bindPlaceMarker=function(e){a.setCurrentPlace(e),window.innerWidth<400&&a.toggleList(),a.searchText(e.name()),console.log(e),c.forEach(function(t){e.id()===t.id&&null!==t.map&&(s(t,r),r.open(map,t),n(t),map.panTo(t.position))})},a.showListings=function(){for(var e=new google.maps.LatLngBounds,t=0;t<c.length;t++)c[t].setMap(map),r.close(map,this),e.extend(c[t].position);map.fitBounds(e),a.enableButton(!1)},a.hideListings=function(){for(var e=0;e<c.length;e++)c[e].setMap(null);a.enableButton(!0)},$(window).resize(function(){console.log("resized"),setTimeout(function(){a.showListings()},1)})};